---
name: Tests and Checks

on:
  workflow_dispatch:
  pull_request:

env:
  FOUNDRY_PROFILE: ci

jobs:
  security:
    uses: lidofinance/linters/.github/workflows/security.yml@master
  actions:
    uses: lidofinance/linters/.github/workflows/actions.yml@master

  linters:
    name: Linters
    runs-on: ubuntu-latest
    steps:
      - name: Bootstrap
        uses: ./.github/workflows/bootstrap.yml

      - name: Linters check
        run: just lint

  foundry:
    name: Foundry project
    runs-on: ubuntu-latest
    steps:
      - name: Bootstrap
        uses: ./.github/workflows/bootstrap.yml

      - name: Build
        run: just build --sizes

      - name: Run tests
        run: just test
        env:
          RPC_URL: ${{ secrets.RPC_URL }}
